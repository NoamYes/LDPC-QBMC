% Author : Miroslav Marinkovic
% E-mail : mmarinkovic78d@gmail.com
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Create the parity check matrix for code rate 1/2, 5/8, 3/4 and 13/16
% IEEE 802.11ad standard

function [H_index] = generate_ldpc_matrix_80211ad(n, code_rate)

% Each H_index matrix has 16 columns (from hc1 to hc16)
if (n ~= 42)
  error('ldpc_matrix_80211ad error: sub-matrix size is not supported');
end

switch code_rate
  case 1/2
    hc1 = [40; 34; -1; -1; 35; 29; -1; -1];    
    hc2 = [-1; -1; 36; 27; -1; -1; 31; 22];    
    hc3 = [38; 35; -1; -1; 41; 0; -1; -1];    
    hc4 = [-1; -1; 31; 18; -1; -1; 23; 34];    
    hc5 = [13; 27; -1; -1; 40; -1; -1; 31];    
    hc6 = [-1; -1; 7; 12; -1; 22; 21; -1];    
    hc7 = [5; -1; -1; 20; 39; -1; -1; 14];    
    hc8 = [-1; 30; 34; -1; -1; 4; 20; -1];    
    hc9 = [18; 2; -1; -1; 28; -1; -1; 4];    
    hc10 = [-1; 1; 10; -1; -1; 28; -1; -1];    
    hc11 = [-1; -1; 41; 15; -1; -1; 12; -1];    
    hc12 = [-1; -1; -1; 6; 3; 27; -1; -1];    
    hc13 = [-1; -1; -1; -1; 28; -1; -1; 13];    
    hc14 = [-1; -1; -1; -1; -1; 23; 0; -1];    
    hc15 = [-1; -1; -1; -1; -1; -1; 13; 22];    
    hc16 = [ -1; -1; -1; -1; -1; -1; -1; 24];    
    
    H_index = cat(2,hc1,hc2,hc3,hc4,hc5,hc6,hc7,hc8,hc9,hc10,hc11,hc12,...
      hc13,hc14,hc15,hc16);
    
  case 5/8
    hc1 = [20; 30; 35; 29; -1; -1];    
    hc2 = [36; 27; -1; -1; 31; 22];    
    hc3 = [34; -1; 41; 0; -1; -1];    
    hc4 = [31; 18; -1; -1; 23; 34];    
    hc5 = [20; -1; 40; -1; -1; 31];    
    hc6 = [7; 12; -1; 22; 21; -1];    
    hc7 = [41; 20; 39; -1; -1; 14];    
    hc8 = [34; 14; -1; 4; 20; -1];    
    hc9 = [-1; 2; 28; -1; -1; 4];    
    hc10 = [10; 25; -1; 28; 9; -1];    
    hc11 = [41; 15; -1; -1; 12; -1];    
    hc12 = [-1; 6; 3; 27; -1; -1];    
    hc13 = [-1; -1; 28; 24; -1; -1];    
    hc14 = [-1; -1; -1; 23; 0; -1];    
    hc15 = [-1; -1; -1; -1; 13; 22];    
    hc16 = [ -1; -1; -1; -1; -1; 24];
    
    H_index = cat(2,hc1,hc2,hc3,hc4,hc5,hc6,hc7,hc8,hc9,hc10,hc11,hc12,...
      hc13,hc14,hc15,hc16);    
    
  case 3/4
    
    hc1 = [35; 29; 37; 25];    
    hc2 = [19; 30; 31; 22];    
    hc3 = [41; 0; 18; 4];    
    hc4 = [22; 8; 23; 34];    
    hc5 = [40; 33; 11; 31];    
    hc6 = [41; 22; 21; 3];    
    hc7 = [39; 17; 6; 14];    
    hc8 = [6; 4; 20; 15];    
    hc9 = [28; 27; 32; 4];    
    hc10 = [18; 28; 9; -1];    
    hc11 = [17; 20; 12; 14];    
    hc12 = [3; 27; 29; 18];    
    hc13 = [28; 24; -1; 13];    
    hc14 = [-1; 23; 0; 13];    
    hc15 = [-1; -1; 13; 22];    
    hc16 = [ -1; -1; -1; 24];    
    
    H_index = cat(2,hc1,hc2,hc3,hc4,hc5,hc6,hc7,hc8,hc9,hc10,hc11,hc12,...
      hc13,hc14,hc15,hc16);
    
  case 13/16
    
    hc1 = [29; 37; 25];    
    hc2 = [30; 31; 22];    
    hc3 = [0; 18; 4];    
    hc4 = [8; 23; 34];    
    hc5 = [33; 11; 31];    
    hc6 = [22; 21; 3];    
    hc7 = [17; 6; 14];    
    hc8 = [4; 20; 15];    
    hc9 = [27; 32; 4];    
    hc10 = [28; 9; 2];    
    hc11 = [20; 12; 14];    
    hc12 = [27; 29; 18];    
    hc13 = [24; 10; 13];    
    hc14 = [23; 0; 13];    
    hc15 = [-1; 13; 22];    
    hc16 = [ -1; -1; 24];
        
    H_index = cat(2,hc1,hc2,hc3,hc4,hc5,hc6,hc7,hc8,hc9,hc10,hc11,hc12,...
      hc13,hc14,hc15,hc16);
    
  otherwise
    error('ldpc_matrix_80211ad error: code rate is not supported');
end

end
